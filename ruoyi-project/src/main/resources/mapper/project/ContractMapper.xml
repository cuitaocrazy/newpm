<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.project.mapper.ContractMapper">
    
    <resultMap type="Contract" id="ContractResult">
        <result property="contractId"    column="contract_id"    />
        <result property="contractCode"    column="contract_code"    />
        <result property="contractName"    column="contract_name"    />
        <result property="customerId"    column="customer_id"    />
        <result property="deptId"    column="dept_id"    />
        <result property="contractType"    column="contract_type"    />
        <result property="contractStatus"    column="contract_status"    />
        <result property="contractSignDate"    column="contract_sign_date"    />
        <result property="contractPeriod"    column="contract_period"    />
        <result property="contractAmount"    column="contract_amount"    />
        <result property="taxRate"    column="tax_rate"    />
        <result property="amountNoTax"    column="amount_no_tax"    />
        <result property="taxAmount"    column="tax_amount"    />
        <result property="confirmAmount"    column="confirm_amount"    />
        <result property="confirmYear"    column="confirm_year"    />
        <result property="freeMaintenancePeriod"    column="free_maintenance_period"    />
        <result property="delFlag"    column="del_flag"    />
        <result property="createBy"    column="create_by"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateBy"    column="update_by"    />
        <result property="updateTime"    column="update_time"    />
        <result property="remark"    column="remark"    />
        <result property="reservedField1"    column="reserved_field1"    />
        <result property="reservedField2"    column="reserved_field2"    />
        <result property="reservedField3"    column="reserved_field3"    />
        <result property="reservedField4"    column="reserved_field4"    />
        <result property="reservedField5"    column="reserved_field5"    />
    </resultMap>

    <sql id="selectContractVo">
        select contract_id, contract_code, contract_name, customer_id, dept_id, contract_type, contract_status, contract_sign_date, contract_period, contract_amount, tax_rate, amount_no_tax, tax_amount, confirm_amount, confirm_year, free_maintenance_period, del_flag, create_by, create_time, update_by, update_time, remark, reserved_field1, reserved_field2, reserved_field3, reserved_field4, reserved_field5 from pm_contract
    </sql>

    <select id="selectContractList" parameterType="Contract" resultMap="ContractResult">
        <include refid="selectContractVo"/>
        <where>
            and del_flag = '0'
            <if test="contractCode != null  and contractCode != ''"> and contract_code = #{contractCode}</if>
            <if test="contractName != null  and contractName != ''"> and contract_name like concat('%', #{contractName}, '%')</if>
            <if test="customerId != null "> and customer_id = #{customerId}</if>
            <if test="deptId != null "> and dept_id = #{deptId}</if>
            <if test="contractType != null  and contractType != ''"> and contract_type = #{contractType}</if>
            <if test="contractStatus != null  and contractStatus != ''"> and contract_status = #{contractStatus}</if>
            <if test="contractSignDate != null "> and contract_sign_date = #{contractSignDate}</if>
            <if test="contractPeriod != null "> and contract_period = #{contractPeriod}</if>
            <if test="contractAmount != null "> and contract_amount = #{contractAmount}</if>
            <if test="taxRate != null "> and tax_rate = #{taxRate}</if>
            <if test="amountNoTax != null "> and amount_no_tax = #{amountNoTax}</if>
            <if test="taxAmount != null "> and tax_amount = #{taxAmount}</if>
            <if test="confirmAmount != null "> and confirm_amount = #{confirmAmount}</if>
            <if test="confirmYear != null  and confirmYear != ''"> and confirm_year = #{confirmYear}</if>
            <if test="freeMaintenancePeriod != null "> and free_maintenance_period = #{freeMaintenancePeriod}</if>
            <if test="reservedField1 != null  and reservedField1 != ''"> and reserved_field1 = #{reservedField1}</if>
            <if test="reservedField2 != null  and reservedField2 != ''"> and reserved_field2 = #{reservedField2}</if>
            <if test="reservedField3 != null  and reservedField3 != ''"> and reserved_field3 = #{reservedField3}</if>
            <if test="reservedField4 != null  and reservedField4 != ''"> and reserved_field4 = #{reservedField4}</if>
            <if test="reservedField5 != null  and reservedField5 != ''"> and reserved_field5 = #{reservedField5}</if>
        </where>
    </select>
    
    <select id="selectContractByContractId" parameterType="Long" resultMap="ContractResult">
        <include refid="selectContractVo"/>
        where contract_id = #{contractId} and del_flag = '0'
    </select>

    <insert id="insertContract" parameterType="Contract" useGeneratedKeys="true" keyProperty="contractId">
        insert into pm_contract
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="contractCode != null">contract_code,</if>
            <if test="contractName != null and contractName != ''">contract_name,</if>
            <if test="customerId != null">customer_id,</if>
            <if test="deptId != null">dept_id,</if>
            <if test="contractType != null and contractType != ''">contract_type,</if>
            <if test="contractStatus != null">contract_status,</if>
            <if test="contractSignDate != null">contract_sign_date,</if>
            <if test="contractPeriod != null">contract_period,</if>
            <if test="contractAmount != null">contract_amount,</if>
            <if test="taxRate != null">tax_rate,</if>
            <if test="amountNoTax != null">amount_no_tax,</if>
            <if test="taxAmount != null">tax_amount,</if>
            <if test="confirmAmount != null">confirm_amount,</if>
            <if test="confirmYear != null">confirm_year,</if>
            <if test="freeMaintenancePeriod != null">free_maintenance_period,</if>
            <if test="delFlag != null">del_flag,</if>
            <if test="createBy != null">create_by,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateBy != null">update_by,</if>
            <if test="updateTime != null">update_time,</if>
            <if test="remark != null">remark,</if>
            <if test="reservedField1 != null">reserved_field1,</if>
            <if test="reservedField2 != null">reserved_field2,</if>
            <if test="reservedField3 != null">reserved_field3,</if>
            <if test="reservedField4 != null">reserved_field4,</if>
            <if test="reservedField5 != null">reserved_field5,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="contractCode != null">#{contractCode},</if>
            <if test="contractName != null and contractName != ''">#{contractName},</if>
            <if test="customerId != null">#{customerId},</if>
            <if test="deptId != null">#{deptId},</if>
            <if test="contractType != null and contractType != ''">#{contractType},</if>
            <if test="contractStatus != null">#{contractStatus},</if>
            <if test="contractSignDate != null">#{contractSignDate},</if>
            <if test="contractPeriod != null">#{contractPeriod},</if>
            <if test="contractAmount != null">#{contractAmount},</if>
            <if test="taxRate != null">#{taxRate},</if>
            <if test="amountNoTax != null">#{amountNoTax},</if>
            <if test="taxAmount != null">#{taxAmount},</if>
            <if test="confirmAmount != null">#{confirmAmount},</if>
            <if test="confirmYear != null">#{confirmYear},</if>
            <if test="freeMaintenancePeriod != null">#{freeMaintenancePeriod},</if>
            <if test="delFlag != null">#{delFlag},</if>
            <if test="createBy != null">#{createBy},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="updateBy != null">#{updateBy},</if>
            <if test="updateTime != null">#{updateTime},</if>
            <if test="remark != null">#{remark},</if>
            <if test="reservedField1 != null">#{reservedField1},</if>
            <if test="reservedField2 != null">#{reservedField2},</if>
            <if test="reservedField3 != null">#{reservedField3},</if>
            <if test="reservedField4 != null">#{reservedField4},</if>
            <if test="reservedField5 != null">#{reservedField5},</if>
         </trim>
    </insert>

    <update id="updateContract" parameterType="Contract">
        update pm_contract
        <trim prefix="SET" suffixOverrides=",">
            <if test="contractCode != null">contract_code = #{contractCode},</if>
            <if test="contractName != null and contractName != ''">contract_name = #{contractName},</if>
            <if test="customerId != null">customer_id = #{customerId},</if>
            <if test="deptId != null">dept_id = #{deptId},</if>
            <if test="contractType != null and contractType != ''">contract_type = #{contractType},</if>
            <if test="contractStatus != null">contract_status = #{contractStatus},</if>
            <if test="contractSignDate != null">contract_sign_date = #{contractSignDate},</if>
            <if test="contractPeriod != null">contract_period = #{contractPeriod},</if>
            <if test="contractAmount != null">contract_amount = #{contractAmount},</if>
            <if test="taxRate != null">tax_rate = #{taxRate},</if>
            <if test="amountNoTax != null">amount_no_tax = #{amountNoTax},</if>
            <if test="taxAmount != null">tax_amount = #{taxAmount},</if>
            <if test="confirmAmount != null">confirm_amount = #{confirmAmount},</if>
            <if test="confirmYear != null">confirm_year = #{confirmYear},</if>
            <if test="freeMaintenancePeriod != null">free_maintenance_period = #{freeMaintenancePeriod},</if>
            <if test="delFlag != null">del_flag = #{delFlag},</if>
            <if test="createBy != null">create_by = #{createBy},</if>
            <if test="createTime != null">create_time = #{createTime},</if>
            <if test="updateBy != null">update_by = #{updateBy},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
            <if test="remark != null">remark = #{remark},</if>
            <if test="reservedField1 != null">reserved_field1 = #{reservedField1},</if>
            <if test="reservedField2 != null">reserved_field2 = #{reservedField2},</if>
            <if test="reservedField3 != null">reserved_field3 = #{reservedField3},</if>
            <if test="reservedField4 != null">reserved_field4 = #{reservedField4},</if>
            <if test="reservedField5 != null">reserved_field5 = #{reservedField5},</if>
        </trim>
        where contract_id = #{contractId}
    </update>

    <update id="deleteContractByContractId" parameterType="Long">
        update pm_contract set del_flag = '1' where contract_id = #{contractId}
    </update>

    <update id="deleteContractByContractIds" parameterType="String">
        update pm_contract set del_flag = '1' where contract_id in
        <foreach item="contractId" collection="array" open="(" separator="," close=")">
            #{contractId}
        </foreach>
    </update>
</mapper>