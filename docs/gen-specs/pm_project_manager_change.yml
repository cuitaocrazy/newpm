# ============================
# RuoYi 代码生成规格文件
# 表名: pm_project_manager_change
# 生成时间: 2026-02-13
# ============================

# ============================
# Tab 1: 基本信息
# ============================
basicInfo:
  tableName: pm_project_manager_change
  tableComment: 项目经理变更表
  className: ProjectManagerChange
  functionAuthor: ruoyi
  remark: ""

# ============================
# Tab 2: 字段信息
# ============================
columns:
  change_id:
    columnComment: 变更主键ID
    columnType: bigint(20)
    javaType: Long
    javaField: changeId
    isInsert: false
    isEdit: false
    isList: true
    isQuery: false
    queryType: EQ
    isRequired: false
    htmlType: input
    dictType: ""

  project_id:
    columnComment: 项目ID
    columnType: bigint(20)
    javaType: Long
    javaField: projectId
    isInsert: true
    isEdit: true
    isList: true
    isQuery: true
    queryType: EQ
    isRequired: true
    htmlType: select
    dictType: ""

  old_manager_id:
    columnComment: 原项目经理ID
    columnType: bigint(20)
    javaType: Long
    javaField: oldManagerId
    isInsert: true
    isEdit: true
    isList: true
    isQuery: true
    queryType: EQ
    isRequired: false
    htmlType: select
    dictType: ""

  new_manager_id:
    columnComment: 新项目经理ID
    columnType: bigint(20)
    javaType: Long
    javaField: newManagerId
    isInsert: true
    isEdit: true
    isList: true
    isQuery: true
    queryType: EQ
    isRequired: true
    htmlType: select
    dictType: ""

  change_reason:
    columnComment: 变更原因
    columnType: varchar(500)
    javaType: String
    javaField: changeReason
    isInsert: true
    isEdit: true
    isList: true
    isQuery: false
    queryType: EQ
    isRequired: false
    htmlType: textarea
    dictType: ""

  del_flag:
    columnComment: 删除标志(0正常 1删除)
    columnType: char(1)
    javaType: String
    javaField: delFlag
    isInsert: false
    isEdit: false
    isList: false
    isQuery: false
    queryType: EQ
    isRequired: false
    htmlType: input
    dictType: ""

  create_by:
    columnComment: 创建者
    columnType: varchar(64)
    javaType: String
    javaField: createBy
    isInsert: false
    isEdit: false
    isList: false
    isQuery: false
    queryType: EQ
    isRequired: false
    htmlType: input
    dictType: ""

  create_time:
    columnComment: 创建时间
    columnType: datetime
    javaType: Date
    javaField: createTime
    isInsert: false
    isEdit: false
    isList: true
    isQuery: true
    queryType: BETWEEN
    isRequired: false
    htmlType: datetime
    dictType: ""

  update_by:
    columnComment: 更新者
    columnType: varchar(64)
    javaType: String
    javaField: updateBy
    isInsert: false
    isEdit: false
    isList: false
    isQuery: false
    queryType: EQ
    isRequired: false
    htmlType: input
    dictType: ""

  update_time:
    columnComment: 更新时间
    columnType: datetime
    javaType: Date
    javaField: updateTime
    isInsert: false
    isEdit: false
    isList: false
    isQuery: false
    queryType: EQ
    isRequired: false
    htmlType: datetime
    dictType: ""

  remark:
    columnComment: 备注
    columnType: varchar(500)
    javaType: String
    javaField: remark
    isInsert: true
    isEdit: true
    isList: false
    isQuery: false
    queryType: EQ
    isRequired: false
    htmlType: textarea
    dictType: ""

# ============================
# Tab 3: 生成信息
# ============================
genInfo:
  tplCategory: crud
  tplWebType: element-plus
  packageName: com.ruoyi.project
  moduleName: project
  businessName: managerChange
  functionName: 项目经理变更
  parentMenuId: 3

# ============================
# 定制需求（超出标准模板的组件/交互/接口需求）
# ============================
customizations:
  project_autocomplete:
    intent: "项目选择，按项目名称远程搜索，提交project_id"
    component:
      type: el-autocomplete
      props:
        fetchSuggestions: "后端远程搜索"
        valueKey: "projectName"
        debounce: 300
        triggerOnFocus: false
    bindTo: project_id
    service:
      endpoint: "GET /project/project/search?projectName={keyword}"
      source: "复用 ProjectService，新增轻量搜索接口返回 id+name"
      returns: "[{ projectId, projectName, projectCode }]"
      newApi: true
    notes: "查询条件和表单中都使用autocomplete，显示项目名称，提交projectId"

  manager_select:
    intent: "项目经理下拉选择，数据来源：岗位编码为'pm'的用户昵称"
    component:
      type: el-select
      props:
        filterable: true
        clearable: true
    bindTo:
      - old_manager_id
      - new_manager_id
    service:
      endpoint: "GET /system/user/listByPost?postCode=pm"
      source: "复用 SysUserController，需新增按岗位编码查询用户接口"
      returns: "[{ userId, nickName, userName }]"
      newApi: true
    notes: "old_manager_id和new_manager_id共用此接口，显示nickName，提交userId。需要关联sys_user_post和sys_post表，查询post_code='pm'的用户"

  pagination_fixed_bottom:
    intent: "分页组件固定在页面底部，即使数据很少也保持在底部位置"
    date: "2026-02-14"
    implementation:
      container:
        className: "manager-change-container"
        styles:
          - "height: 100%"
          - "display: flex"
          - "flex-direction: column"
      table:
        dynamicHeight: true
        heightRef: "const tableHeight = ref(600)"
        heightCalculation: "tableHeight.value = windowHeight - searchHeight - toolbarHeight - paginationHeight - padding"
        attributes:
          - "border: 添加表格边框"
          - "stripe: 添加斑马纹效果"
          - "style='width: 100%': 确保表格占满容器宽度"
      lifecycle:
        onMounted:
          - "calcTableHeight(): 初始计算表格高度"
          - "window.addEventListener('resize', calcTableHeight): 监听窗口大小变化"
          - "loadManagerList(): 加载项目经理列表"
          - "getList(): 加载数据"
        onUnmounted:
          - "window.removeEventListener('resize', calcTableHeight): 移除resize监听"
        watch:
          - "showSearch: 搜索框显隐时重新计算表格高度"
      pagination:
        position: "紧跟el-table后，对话框之前"
        styles:
          - "margin-top: 15px"
          - "text-align: right"
      heightParameters:
        searchHeight: "100px (showSearch为true时)"
        toolbarHeight: "50px"
        paginationHeight: "50px"
        padding: "120px"
    notes: "参考合同管理页面实现，通过flex布局和动态计算表格高度，确保分页组件始终固定在页面底部，提升用户体验。关键是表格设置固定高度而不是自适应内容高度。"
